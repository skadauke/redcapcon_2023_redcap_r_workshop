---
title: "Transforming and Visualizing Data With R"
format: html
editor: visual
---

```{r}
library(tidyverse)

infusion_vitals <- redcart |>
  extract_tibble("infusion_vital_signs") |>
  select(-infusion_vitals_comments, -redcap_event, -form_status_complete) |>
  pivot_longer(starts_with("infusion_vitals_")) |>
  filter(stringr::str_detect(name, "_post_temp_")) |>
  mutate(time = name |> 
           str_remove("infusion_vitals_post_temp_") |>
           as.integer() * 15
  ) |>
  rename(temperature = value) |>
  select(-name)
```

```{r}
ggplot(
  data = infusion_vitals, 
  aes(x = time, y = temperature, color = infseq_id)
) + 
  geom_line()
```
